{% extends 'base.html' %}
{% block title %}
home page
{% endblock title %}
{% block head %}
{{ super() }}
{% endblock head %}
{% block content %}
{% block navbar %}
    {{ super() }}
{% endblock navbar %}
{% block form %}
    {{ super() }}
{% endblock form %}
{% block table %}
    <!-- to-do list table -->
    <table class="table table-hover mt-5">
        <thead>
            <!-- table heading -->
          <tr>
            <th scope="col">S No.</th>
            <th scope="col">Task Name</th>
            <th scope="col">Task Description</th>
            <th scope="col">Sub Tasks</th>
            <th scope="col">Task Date</th>
          </tr>
        </thead>
        <tbody>
            {% for task in allTodo  %}
            <tr>
              <td>{{loop.index}}</td>
              <td>{{task.task_name}}</td>
              <td>{{task.task_desc}}</td>
              <!-- sub task cell for the row -->
              <td>
                <form action="/delete/{{ task.SNo }}" id={{task.task_name}} method="post" >

                  <div class="form-check">
                    <p>
                        {{ sub_form.cst1(onChange = "submit_form()") }} {{task.sub_task1}}
                    </p>
                    </label>
                  </div>
                  <div class="form-check">
                    <p>
                        {{ sub_form.cst2(onChange = "submit_form()") }} {{task.sub_task2}}
                    </p>
                  </div>
                  <div class="form-check">
                    <p>
                        {{ sub_form.cst3(onChange = "submit_form()")}} {{task.sub_task3}}
                    </p>
                </form>
                <script>

                    function submit_form(){
                    
                        var subm1 = document.getElementById('cst1');
                        var subm2 = document.getElementById( 'cst2');
                        var subm3 = document.getElementById('cst3');
                        var form = document.getElementById('{{ task.task_name| tojson | safe }}');
    
                        if ((subm1.checked == true) && (subm2.checked == true) && (subm3.checked == true))
                        {
                            subm1.form.submit()
                            console.log(form)
                        }
                    }

                </script>
                  </div>
              </td>
              
              <td>{{task.declared_at}}</td>


            </tr>
        {% endfor %}
        </tbody>
      </table>
{% endblock table %}
{% endblock content %}
{% block footer %}
{{super()}}
{% endblock footer %}